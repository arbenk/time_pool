<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>计时器</title>
<link rel="shortcut icon" href="icon.svg" type="image/x-icon">
 <link rel="shortcut icon" href="icon.ico " type="image/x-icon">
 <link rel="icon" sizes="any" mask="" href="icon.ico">
<link rel="shortcut icon" href="icon.ico">
 <link rel="apple-touch-icon-precomposed" href="icon-full.svg">
<link rel="icon" type="image/svg+xml" href="icon.svg">
<!-- 引入css -->
<link rel="stylesheet" href="mainStyle.css">
</head>
<body class="dark-mode">

    <div id="view-main">
        <header><div style="display: flex; align-items: center; gap: 8px;">
            <img src="icon.svg" alt="SVG Image" width="40" height="40">
            <h1>计时器</h1>
            </div>
            <div style="display: flex; gap: 10px; align-items: center;">
                <button class="btn btn-outline" onclick="toggleTheme()">🌗</button>
                <button class="btn btn-green" id="btnAddProject" onclick="openCreateModal()">➕添加时间池</button>
                <button class="btn btn-red" id="btnCleanAll" onclick="cleanAllRecycle()" style="display:none;">⚠️清空回收站</button>
            </div>
        </header>

        <div class="view-tabs">
            <button class="tab-btn active" id="tabActive" onclick="switchView('active')">我的项目</button>
            <button class="tab-btn" id="btnToggleView" onclick="toggleViewMode()">≡ 折叠显示</button>
            <button class="tab-btn" id="tabRecycle" onclick="switchView('recycle')">🗑️ 回收站</button>
        </div>

        <div class="grid" id="projectGrid"></div>
    </div>

    <div id="view-history" style="display: none; max-width: 800px; margin: 0 auto;">
        <header style="margin-bottom: 20px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px;">
            <div style="display: flex; justify-content: flex-start;">
                <button class="btn btn-outline" onclick="backToMain()">⬅️ 返回列表</button>
            </div>
            <div style="display: flex; justify-content: flex-end;">
                 <button class="btn btn-red" onclick="clearHistoryFromPage()">🗑️ 清空历史</button>
            </div>
        </header>
        <div style="margin-bottom: 10px; display: flex; justify-content: center;">
        <h2 id="historyPageTitle" style="margin:auto; color: var(--text-color);">项目历史记录</h2>
        </div>
        <span  style="margin-bottom: 10px; display: flex; justify-content: center;color: #666;">历史记录</span>
        
        <div id="fullHistoryList" class="history-list-full">
            </div>
        <input type="hidden" id="fullHistoryProjectId">
    </div>

    <div id="projectModal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <span class="modal-title" id="projectModalTitle">添加项目</span>
                <button class="close-btn" onclick="closeModal('projectModal')">&times;</button>
            </div>
            <input type="hidden" id="editProjectId">
            <div class="form-group">
                <label class="form-label">项目名称</label>
                <input type="text" id="pName" class="form-input" placeholder="输入项目名称">
            </div>
            <div class="form-group">
                <label class="form-label">项目描述</label>
                <textarea id="pDesc" class="form-textarea" rows="2" placeholder="输入描述"></textarea>
            </div>
            <div class="form-group" id="poolInputs">
                <label class="form-label">预估时间 (时间池)</label>
                <div class="row-inputs">
                    <input type="number" id="pHours" class="form-input" placeholder="小时" value="0">
                    <input type="number" id="pMins" class="form-input" placeholder="分钟" value="0">
                </div>
            </div>
            <div style="display: flex; justify-content: space-between;">
                <button class="btn btn-red" id="btnDeleteProject" style="display:none;" onclick="recycleProject()">🗑️ 删除</button>
                <div style="flex:1;"></div>
                <button class="btn btn-outline" onclick="closeModal('projectModal')" style="margin-right: 10px;">取消</button>
                <button class="btn btn-primary" onclick="saveProject()">保存</button>
            </div>
        </div>
    </div>

    <div id="adjustModal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <span class="modal-title" id="adjustTitle">修改时间</span>
                <button class="close-btn" onclick="closeModal('adjustModal')">&times;</button>
            </div>
            <input type="hidden" id="adjustProjectId">
            <input type="hidden" id="adjustTarget">
            
            <div class="form-group">
                <label class="form-label">操作类型</label>
                <div class="row-inputs">
                    <button class="btn btn-full btn-blue" onclick="setAdjustMethod('add')" id="btnMethodAdd">增加时间</button>
                    <button class="btn btn-full btn-outline" onclick="setAdjustMethod('sub')" id="btnMethodSub">减少时间</button>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">时间量</label>
                <div class="row-inputs">
                    <input type="number" id="adjHours" class="form-input" placeholder="小时" value="0">
                    <input type="number" id="adjMins" class="form-input" placeholder="分钟" value="0">
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">备注 (必填)</label>
                <input type="text" id="adjRemark" class="form-input" placeholder="输入修改原因">
            </div>
            <div style="text-align: right;">
                <button class="btn btn-primary" onclick="submitAdjust()">确认修改</button>
            </div>
        </div>
    </div>

    <div id="stopModal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <span class="modal-title">完成计时 - 填写备注</span>
                <button class="close-btn" onclick="closeModal('stopModal')">&times;</button>
            </div>
            <input type="hidden" id="stopProjectId">
            <div class="form-group">
                <label class="form-label">本次工作内容 (必填)</label>
                <textarea id="stopRemarkInput" class="form-textarea" rows="3" placeholder="例如：完成了登录页面的UI设计..."></textarea>
            </div>
            <div style="text-align: right;">
                <button class="btn btn-outline" onclick="closeModal('stopModal')" style="margin-right: 10px;">取消</button>
                <button class="btn btn-primary" onclick="submitStopTimer()">✅ 提交并停止</button>
            </div>
        </div>
    </div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
<script src="mainScript.js"></script>
</body>

</html>
